function Vector(n,t){this.x=n;this.y=t}function Petal(n,t,i,r,u,f){this.stretchA=n;this.stretchB=t;this.startAngle=i;this.angle=r;this.bloom=f;this.growFactor=u;this.r=1;this.isfinished=!1}function Bloom(n,t,i,r,u){this.p=n;this.r=t;this.c=i;this.pc=r;this.petals=[];this.garden=u;this.init();this.garden.addBloom(this)}function Garden(n,t){this.blooms=[];this.element=t;this.ctx=n}Vector.prototype={rotate:function(n){var t=this.x,i=this.y;return this.x=Math.cos(n)*t-Math.sin(n)*i,this.y=Math.sin(n)*t+Math.cos(n)*i,this},mult:function(n){return this.x*=n,this.y*=n,this},clone:function(){return new Vector(this.x,this.y)},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},subtract:function(n){return this.x-=n.x,this.y-=n.y,this},set:function(n,t){return this.x=n,this.y=t,this}};Petal.prototype={draw:function(){var n=this.bloom.garden.ctx,t=new Vector(0,this.r).rotate(Garden.degrad(this.startAngle)),i=t.clone().rotate(Garden.degrad(this.angle)),r=t.clone().mult(this.stretchA),u=i.clone().mult(this.stretchB);n.strokeStyle=this.bloom.c;n.beginPath();n.moveTo(t.x,t.y);n.bezierCurveTo(r.x,r.y,u.x,u.y,i.x,i.y);n.stroke()},render:function(){this.r<=this.bloom.r?(this.r+=this.growFactor,this.draw()):this.isfinished=!0}};Bloom.prototype={draw:function(){var t,i=!0,n;for(this.garden.ctx.save(),this.garden.ctx.translate(this.p.x,this.p.y),n=0;n<this.petals.length;n++)t=this.petals[n],t.render(),i*=t.isfinished;this.garden.ctx.restore();i==!0&&this.garden.removeBloom(this)},init:function(){for(var t=360/this.pc,i=Garden.randomInt(0,90),n=0;n<this.pc;n++)this.petals.push(new Petal(Garden.random(Garden.options.petalStretch.min,Garden.options.petalStretch.max),Garden.random(Garden.options.petalStretch.min,Garden.options.petalStretch.max),i+n*t,t,Garden.random(Garden.options.growFactor.min,Garden.options.growFactor.max),this))}};Garden.prototype={render:function(){for(var n=0;n<this.blooms.length;n++)this.blooms[n].draw()},addBloom:function(n){this.blooms.push(n)},removeBloom:function(n){for(var i,t=0;t<this.blooms.length;t++)if(i=this.blooms[t],i===n)return this.blooms.splice(t,1),this},createRandomBloom:function(n,t){this.createBloom(n,t,Garden.randomInt(Garden.options.bloomRadius.min,Garden.options.bloomRadius.max),Garden.randomrgba(Garden.options.color.rmin,Garden.options.color.rmax,Garden.options.color.gmin,Garden.options.color.gmax,Garden.options.color.bmin,Garden.options.color.bmax,Garden.options.color.opacity),Garden.randomInt(Garden.options.petalCount.min,Garden.options.petalCount.max))},createBloom:function(n,t,i,r,u){new Bloom(new Vector(n,t),i,r,u,this)},clear:function(){this.blooms=[];this.ctx.clearRect(0,0,this.element.width,this.element.height)}};Garden.options={petalCount:{min:8,max:15},petalStretch:{min:.1,max:3},growFactor:{min:.1,max:1},bloomRadius:{min:8,max:10},density:10,growSpeed:1e3/60,color:{rmin:128,rmax:255,gmin:0,gmax:128,bmin:0,bmax:128,opacity:.1},tanAngle:60};Garden.random=function(n,t){return Math.random()*(t-n)+n};Garden.randomInt=function(n,t){return Math.floor(Math.random()*(t-n+1))+n};Garden.circle=2*Math.PI;Garden.degrad=function(n){return Garden.circle/360*n};Garden.raddeg=function(n){return n/Garden.circle*360};Garden.rgba=function(n,t,i,r){return"rgba("+n+","+t+","+i+","+r+")"};Garden.randomrgba=function(n,t,i,r,u,f,e){var o=Math.round(Garden.random(n,t)),s=Math.round(Garden.random(i,r)),h=Math.round(Garden.random(u,f)),c=5;return Math.abs(o-s)<=c&&Math.abs(s-h)<=c&&Math.abs(h-o)<=c?Garden.rgba(n,t,i,r,u,f,e):Garden.rgba(o,s,h,e)};